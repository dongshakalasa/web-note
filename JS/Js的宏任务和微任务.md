# 宏任务和微任务

## 1、什么是宏任务？什么是微任务？

​		JavaScript是一门单线程语言，所以它本身是没有异步的，但是JavaScript的宿主环境（比如浏览器、node.js）是多线程的，宿主环境通过某种方式（事件驱动）使js具备了异步的属性。在js中我们一般将所有的任务都分成两类，同步任务和异步任务，而异步任务又可以分为，微任务和宏任务

## 2、宏任务

包括：主要代码块、setTimeout、setInterval、DOM事件、AJAX请求。

浏览器为了能够使得JS内部任务与DOM任务能够有序的执行，会在一个任务执行结束后，在下一个任务执行开始前，对页面进行重新渲染 。

## 3、微任务

包括：Promise、async/await、process.[nextTick](https://so.csdn.net/so/search?q=nextTick&spm=1001.2101.3001.7020)。

微任务通常来说就是需要在当前 同步任务执行结束后立即执行的任务，比如对一系列动作做出反馈，或者是需要异步的执行任务而又不需要分配一个新的任务，这样便可以减小一点性能的开销。

## 4、总结

- 微任务是在宏任务的执行中产生的，所以一开始程序执行时是没有微任务的。
- 系统将微任务执行完以后，才会去执行下一个宏任务。
- 宏任务里如果有宏任务，不会执行里面的那个宏任务，而是被丢进任务队列后面，所以会最后执行。
- 宿主环境提供的属于宏任务：例如setTimeout。由语言标准提供的属于微任务：例如promise.then。可以以此来区分宏任务和微任务。

## 5、例题讲解

- 执行结果：2431

```js
	setTimeout(function(){
		    console.log('1')
		});
	new Promise(function(resolve){
	    console.log('2');
      	resolve();
	}).then(function(){
	    console.log('3')
	});
 
	console.log('4');
```
