# 一、重绘 和 回流是什么

重绘不一定导致回流，但回流一定会导致重绘
回流（Reflow） && 重绘（Redraw）会付出高昂的性能代价

## 1、重绘

**重绘 （Redraw）**：某些元素的外观被改变所触发的浏览器行为（重新计算节点在屏幕中的绝对位置并渲染的过程）； 例如：修改元素的填充颜色，会触发重绘；

## 2、回流

回流（Reflow）重新生成布局，重新排列元素（重新计算各节点和css具体的大小和位置：渲染树需要重新计算所有受影响的节点**）；例如：改元素的宽高，会触发回流；

**注**：回流要比重绘的成本大得多，我们应该尽量减少重排操作，减少页面性能消耗

# 二、那些操作会导致重绘和回流呢

## 1、能导致重绘

- color
- border-style
- border-radius
- text-decoration
- box-shadow
- outline
- background
- 。。。

## 2、能导致回流

- 页面初始渲染，这是开销最大的一次重排;
- 添加/删除可见的DOM元素;
- 改变元素位置;
- 改变元素尺寸，比如边距、填充、边框、宽度和高度等;
- 改变元素内容，比如文字数量，图片大小等;
- 改变元素字体大小;
- 改变浏览器窗口尺寸，比如resize事件发生时;
- 激活CSS伪类（例如：:hover）;
- 设置 style 属性的值，因为通过设置style属性改变结点样式的话，每一次设置都会触发一次reflow;
- 查询某些属性或调用某些计算方法：offsetWidth、offsetHeight等，除此之外，当我们调用getComputedStyl方法，或者IE里的 currentStyle 时，也会触发重排，原理是一样的，都为求一个“即时性”和“准确性”;
- 。。。

# 三、回流的影响

- 全局范围：从根节点html开始对整个渲染树进行重新布局；
- 局部范围：对渲染树的某部分或某一个渲染对象进行重新布局；

## 1、优化建议

核心观念： 减少重排次数和减小重排范围

1. 样式集中改变（把需要改变的样式，写成类名）
2. 将 DOM 离线（通过先隐藏dom，进行操作，最后显示dom减少回流）
3. 脱离文档流： 使用 absolute 或 fixed 脱离文档流（减小重排范围）
4. 善用内存：在内存中多次操作DOM，再整个添加到DOM树(先用小容器存放需要创建的dom，最后把小容器放入大容器，一次回流)
5. 读写分离：将写入的值缓存，读取缓存的值（将多次因此回流的值，存储起来）